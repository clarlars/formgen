
<!doctype html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <!--
            <script type="text/javascript" src="/default/system/js/odkCommon.js"></script>
        -->
        <script type="text/javascript" src="/default/system/js/odkData.js"></script>
        <script>
var S4 = function S4() {
    return (((1+Math.random())*0x10000)|0).toString(16).substring(1); 
}
var newGuid = function newGuid() {
    return (S4() + S4() + "-" + S4() + "-4" + S4().substr(0,3) + "-" + S4() + "-" + S4() + S4() + S4()).toLowerCase();
}
var add = function() {
    document.location.href = "/default/config/assets/formgen/"+table_id+"#" + newGuid();
}
var table_id = "";
var display_cols = {"femaleClients": "_id", "Ethiopia_household": "household_id", "food_bout": "_id", "sms_example": "_id", "scan_example": "_id", "adult_coverage": "_id", "selects": "_id", "plot": "plot_name", "Ethiopia_members": "name", "imgci": "_id", "breathcounter": "_id", "geoweather": "Description_Date", "farms": "farm_uuid", "other_species": "_id", "graphExample": "_id", "household": "household_id", "twoColumn": "_id", "follow_map_time": "_id", "visit": "_id", "customAppearance": "_id", "eonasdan": "_id", "Tea_types": "Name", "section_test": "_id", "groom_bout": "_id", "household_member": "name", "Tea_houses": "Name", "refrigerators": "_id", "sign": "_id", "geopoints": "_id", "exampleForm": "_id", "geoweather_conditions": "Description", "follow_arrival": "_id", "gridScreen": "_id", "farm_field": "field_uuid", "follow": "_id", "farm_crop": "crop_name", "agriculture": "plot_name", "send_sms": "_id", "large_dataset": "object_name", "complex_validate_test": "_id", "imnci": "_id", "Tea_inventory": "_id", "mating_event": "_id", "datatypes": "_id", "testRun": "test", "geotagger_default_location": "_id", "geotagger": "_id", "child_coverage": "_id", "follow_map_position": "_id", "Tea_houses_editable": "Name", "selects_demo": "_id", "maleClients": "_id"}
var display_col = "";

var ol = function ol() {
    table_id = document.location.hash.slice(1);
    display_col = display_cols[table_id];
    var list = document.getElementById("list");
    if (table_id.length == 0) {
        list.innerText = "No table specified!";
        // TODO - redirect to tables.html
        return;
    }

    // Escape the LIMIT 1
    odkData.arbitraryQuery(table_id, "SELECT * FROM "+table_id, [], 1000, 0, function(d) {
        for (var i = 0; i < d.getCount(); i++) {
            var span = document.createElement("span");
            span.innerText = d.getData(i, display_col);
            var edit = document.createElement("button");
            edit.innerText = "Edit";
            (function(edit, i, d) {
                edit.addEventListener("click", function() {
                    document.location.href = "/default/config/assets/formgen/"+table_id+"#" + d.getData(i, "_id");
                });
            })(edit, i, d);
            span.appendChild(edit);
            //span.appendChild(document.createElement("br"));
            span.style.width = "100%";
            list.appendChild(span);
        }
    }, function(d) {
        alert("Failure! " + d);
    });
}
        </script>
    </head>
    <body onLoad="ol();">
        <div id="header">Refrigerators<button onClick='add();'>Add</button></div>
        <div id="list"></div>
    </body>
</html>
